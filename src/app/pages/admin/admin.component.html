<app-admin-modal (userUpdated)="refreshUsers()" (userUpdateFailed)="notifyFail()" #userModal></app-admin-modal>
<app-error-toast [message]="'Failed to update user.'" [timeout]="3000" #errorToast></app-error-toast>

<div class="container mx-auto">
  <h2 class="py-4 text-center text-6xl my-8 text-white">User Info</h2>
  @if (user) {
    <div class="text-white">
      <p>Name: {{ user.name }}</p>
      <p>Email: {{ user.email }}</p>
      <p>Email is verified: {{ user.email_verified }}</p>
      <p>unique id: {{ user.sub }}</p>
      <p>gender: {{ user.gender }}</p>
    </div>
  }

  <div>
    <h2 class="py-4 text-center text-6xl my-8 text-white">Users</h2>
    <div
      class="relative overflow-x-auto m-2 lg:mx-20 rounded-lg p-0.5 bg-gradient-to-br from-secondary to-accent">
      <div class="relative overflow-x-auto shadow-md sm:rounded-lg">
        <table
          class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
          <colgroup>
            <col span="1" style="width: 60%" />
            <col span="1" style="width: 25%" />
            <col span="1" style="width: 15%" />
          </colgroup>
          <thead
            class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
            <tr>
              <th scope="col" class="px-6 py-3">
                <i class="fa-solid fa-envelope"></i>
                <span class="ml-2">Email</span>
              </th>
              <th scope="col" class="px-6 py-3 text-center">
                <i class="fa-solid fa-screwdriver-wrench"></i>
                <span class="ml-2">Admin</span>
              </th>
              <th scope="col" class="px-6 py-3 text-center">
                <i class="fa-solid fa-pen"></i>
                <span class="ml-2">Action</span>
              </th>
            </tr>
          </thead>
          <tbody>
            @for (userObject of users$ | async; track $index) {
              <tr
                class="odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700">
                <th
                  scope="row"
                  class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                  {{ userObject.email }}
                </th>
                <td class="px-6 py-4 flex items-center justify-center">
                  @if (userObject.isAdmin) {
                    <i class="fa-solid fa-check text-green-500"></i>
                  } @else {
                    <i class="fa-solid fa-x text-red-500"></i>
                  }
                </td>
                <th
                  scope="row"
                  class="px-6 py-4 font-medium whitespace-nowrap text-center text-accent hover:underline">
                  <a (click)="userModal.show(userObject)">edit</a>
                </th>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <h2 class="py-4 text-center text-6xl my-8 text-white">Manage Content</h2>
  <div class="flex flex-wrap justify-center items-stretch gap-4">
    <app-admin-button
      [text]="'Manage Artists'"
      [destination]="'/manage-artists'"
      [icon_classes]="'fa-solid fa-user'"></app-admin-button>
    <app-admin-button
      [text]="'Manage Days'"
      [destination]="'/line-up'"
      [icon_classes]="'fa-solid fa-calendar-day'"></app-admin-button>
    <app-admin-button
      [text]="'Manage Genres'"
      [destination]="'/line-up'"
      [icon_classes]="'fa-solid fa-record-vinyl'"></app-admin-button>
    <app-admin-button
      [text]="'Manage Performances'"
      [destination]="'/line-up'"
      [icon_classes]="'fa-solid fa-guitar'"></app-admin-button>
  </div>
</div>
